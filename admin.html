<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Control Panel - Emery Campbell Consulting</title>

<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;600&family=Montserrat:wght@300;400;500;600&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Montserrat',sans-serif;background:#f4f4f4;display:flex;}

/* SIDEBAR */
.sidebar{
width:260px;background:#111;color:#fff;
min-height:100vh;padding:30px 20px;
}
.sidebar h2{
font-family:'Cormorant Garamond',serif;
margin-bottom:40px;text-align:center;
}
.sidebar ul{list-style:none;}
.sidebar li{margin-bottom:20px;cursor:pointer;opacity:0.8;}
.sidebar li:hover{opacity:1;}

/* MAIN */
.main{flex:1;padding:40px;}
.header{
display:flex;justify-content:space-between;
align-items:center;margin-bottom:30px;
}
.logout{
padding:8px 18px;background:#000;color:#fff;
border:none;border-radius:6px;cursor:pointer;
}

/* CARDS */
.cards{
display:grid;
grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
gap:20px;margin-bottom:30px;
}
.card{
background:#fff;padding:20px;border-radius:10px;
box-shadow:0 5px 20px rgba(0,0,0,0.05);
}
.card h3{font-size:0.9rem;color:#777;}
.card p{font-size:1.4rem;font-weight:600;margin-top:10px;}

/* TABLE */
.table-container{
background:#fff;padding:20px;
border-radius:10px;
box-shadow:0 5px 20px rgba(0,0,0,0.05);
}
table{width:100%;border-collapse:collapse;}
th,td{padding:10px;border-bottom:1px solid #eee;font-size:0.85rem;}
th{background:#fafafa;}
select,input[type="number"]{padding:4px;border-radius:4px;border:1px solid #ccc;}
button.small{padding:4px 8px;font-size:0.75rem;margin-left:5px;cursor:pointer;border:none;border-radius:4px;}
.delete{background:#c0392b;color:#fff;}
.save{background:#C19A6B;color:#fff;}

/* SEARCH */
.search{
margin-bottom:15px;
padding:8px;width:250px;border-radius:6px;border:1px solid #ccc;
}

/* AI */
.ai-box{
background:#fff;padding:20px;
border-radius:10px;margin-top:30px;
box-shadow:0 5px 20px rgba(0,0,0,0.05);
}
</style>
</head>

<body>

<div class="sidebar">
<h2>ADMIN PANEL</h2>
<ul>
<li onclick="showSection('dashboard')">Dashboard</li>
<li onclick="showSection('clients')">Clients</li>
<li onclick="showSection('ai')">Admin AI</li>
</ul>
</div>

<div class="main">

<div class="header">
<h1>Control Center</h1>
<button class="logout" onclick="logout()">Logout</button>
</div>

<!-- DASHBOARD -->
<div id="dashboardSection">
<div class="cards">
<div class="card"><h3>Total Users</h3><p id="totalUsers"></p></div>
<div class="card"><h3>Total Revenue (Demo)</h3><p id="totalRevenue"></p></div>
<div class="card"><h3>Paid Clients</h3><p id="paidClients"></p></div>
<div class="card"><h3>Unpaid Clients</h3><p id="unpaidClients"></p></div>
</div>
</div>

<!-- CLIENTS -->
<div id="clientsSection" style="display:none;">
<input type="text" class="search" placeholder="Search client..." onkeyup="searchClient(this.value)">
<div class="table-container">
<table>
<thead>
<tr>
<th>Email</th>
<th>Service</th>
<th>Phase</th>
<th>Progress %</th>
<th>Payment</th>
<th>Actions</th>
</tr>
</thead>
<tbody id="clientTable"></tbody>
</table>
</div>
</div>

<!-- AI -->
<div id="aiSection" style="display:none;">
<div class="ai-box">
<h2>Admin AI Assistant</h2>
<p>This AI can summarize client data and suggest next steps.</p>
<textarea id="adminAIInput" rows="3" style="width:100%;margin-top:10px;padding:8px;"></textarea>
<button class="save" onclick="runAI()">Run AI</button>
<div id="aiResponse" style="margin-top:15px;font-size:0.9rem;"></div>
</div>
</div>

</div>

<script>
const currentUser=JSON.parse(localStorage.getItem("currentUser"));
if(!currentUser||currentUser.role!=="admin"){
window.location.href="login.html";
}

let users=JSON.parse(localStorage.getItem("users"))||[];

/* DEFAULT PROJECT DATA */
users.forEach(u=>{
if(!u.phase)u.phase="Planning";
if(!u.progress)u.progress=20;
if(!u.payment)u.payment="Unpaid";
});
localStorage.setItem("users",JSON.stringify(users));

function loadDashboard(){
document.getElementById("totalUsers").textContent=users.length;
const paid=users.filter(u=>u.payment==="Paid").length;
const unpaid=users.filter(u=>u.payment!=="Paid").length;
document.getElementById("paidClients").textContent=paid;
document.getElementById("unpaidClients").textContent=unpaid;
document.getElementById("totalRevenue").textContent="$"+(paid*1500);
}

function loadClients(){
const table=document.getElementById("clientTable");
table.innerHTML="";
users.forEach((u,index)=>{
if(u.role==="admin")return;
table.innerHTML+=`
<tr>
<td>${u.email}</td>
<td>
<select onchange="updateService(${index},this.value)">
<option ${u.service==="Website Design & Development"?"selected":""}>Website Design & Development</option>
<option ${u.service==="Online Business Management"?"selected":""}>Online Business Management</option>
</select>
</td>
<td>
<select onchange="updatePhase(${index},this.value)">
<option ${u.phase==="Planning"?"selected":""}>Planning</option>
<option ${u.phase==="Design"?"selected":""}>Design</option>
<option ${u.phase==="Development"?"selected":""}>Development</option>
<option ${u.phase==="Completed"?"selected":""}>Completed</option>
</select>
</td>
<td>
<input type="number" value="${u.progress}" min="0" max="100" onchange="updateProgress(${index},this.value)">
</td>
<td>
<select onchange="updatePayment(${index},this.value)">
<option ${u.payment==="Unpaid"?"selected":""}>Unpaid</option>
<option ${u.payment==="Paid"?"selected":""}>Paid</option>
</select>
</td>
<td>
<button class="small delete" onclick="deleteUser(${index})">Delete</button>
</td>
</tr>
`;
});
}

function updateService(i,val){users[i].service=val;save();}
function updatePhase(i,val){users[i].phase=val;save();}
function updateProgress(i,val){users[i].progress=val;save();}
function updatePayment(i,val){users[i].payment=val;save();loadDashboard();}
function deleteUser(i){users.splice(i,1);save();loadClients();loadDashboard();}

function save(){
localStorage.setItem("users",JSON.stringify(users));
}

function searchClient(val){
val=val.toLowerCase();
const rows=document.querySelectorAll("#clientTable tr");
rows.forEach(row=>{
row.style.display=row.innerText.toLowerCase().includes(val)?"":"none";
});
}

function showSection(section){
document.getElementById("dashboardSection").style.display="none";
document.getElementById("clientsSection").style.display="none";
document.getElementById("aiSection").style.display="none";
document.getElementById(section+"Section").style.display="block";
}

function logout(){
localStorage.removeItem("currentUser");
window.location.href="login.html";
}

/* AI */
function runAI(){
const input=document.getElementById("adminAIInput").value;
document.getElementById("aiResponse").innerHTML=
"AI Suggestion: Based on current data, follow up with unpaid clients and move planning projects into design phase.";
}

loadDashboard();
loadClients();
</script>

</body>
</html>
