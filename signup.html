<script>
function trackActivity(action, page = '') {
    const userData = JSON.parse(localStorage.getItem('userData') || '{"activity":[]}');

    if (!userData.activity) {
        userData.activity = [];
    }

    userData.activity.push({
        action: action,
        page: page,
        timestamp: new Date().toISOString(),
        date: new Date().toLocaleString()
    });

    localStorage.setItem('userData', JSON.stringify(userData));
}

function handleSignup(e) {
    e.preventDefault();

    const name = document.getElementById('signupName').value.trim();
    const email = document.getElementById('signupEmail').value.trim();
    const password = document.getElementById('signupPassword').value;
    const confirm = document.getElementById('signupConfirm').value;

    if (password !== confirm) {
        alert('Passwords do not match!');
        return;
    }

    if (localStorage.getItem('userData')) {
        alert('An account already exists on this device.');
        return;
    }

    const userData = {
        name,
        email,
        password, // temporary until backend
        signupDate: new Date().toISOString(),
        business: {},
        websitePrefs: {},
        activity: [{
            action: 'Account Created',
            page: 'signup.html',
            timestamp: new Date().toISOString(),
            date: new Date().toLocaleString()
        }]
    };

    localStorage.setItem('userLoggedIn', 'true');
    localStorage.setItem('userData', JSON.stringify(userData));

    alert('Welcome ' + name + '! Your account has been created.');

    window.location.href = 'account.html';
}
</script>
